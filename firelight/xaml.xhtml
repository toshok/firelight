<?xml version='1.0'?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:svg="http://www.w3.org/2000/svg">
  <head>
    <title>firelight</title>
    <script type="text/javascript" src="jquery-1.2.6.js" />
    <script type="text/javascript" src="firelight-debug.js" />

    <script type="text/javascript">
      <![CDATA[
	$(document).ready(function() {
	  var host = new SvgHost ();
          host.setDOMElement (document.getElementById("svg-host")); // jquery doesn't seem to work here

	  XamlReader.loadFromUrl ("test3.xaml",
                                  function (root) {

//                                      host.findName("canvas").addEventListener ("MouseLeftButtonDown",
//                                                                                function(sender, args) { alert ("button down!"); });

                                      host.setRootVisual (root);
				      setTimeout (animate, 10);
                                  });
	});

	function animate () {
		 var translate_endpoint = 500;
		 var translate_tickAmount = 5;
		 var rect = rootVisual.children.getItemAt(0);
		 var tickTime = 50;

		 var rotate = rootVisual.findName("rotate");
		 var rotate_tickAmount = 5;
		 var rotate_endpoint = 360;

		 function animateTimeout () {
		 	  var need_timeout = false;

		 	  // translate
		 	  if (Canvas.getLeft (rect) < translate_endpoint) {
			     need_timeout = true;
			     Canvas.setLeft (rect, Canvas.getLeft (rect) + translate_tickAmount);
			  }

			  // rotate
			  if (rotate.angle < rotate_endpoint) {
			     need_timeout = true;
			     rotate.angle += rotate_tickAmount;
			  }

			  if (need_timeout)
			    setTimeout (animateTimeout, tickTime);
		 }
		 setTimeout (animateTimeout, tickTime);
	}
      ]]>
    </script>
  </head>

  <body>
    <svg:svg id="svg-host"
	     width="1024"
	     height="768"
	     version="1.1" />
  </body>
</html>
